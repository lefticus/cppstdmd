%%--------------------------------------------------
%% simplified_macros.tex
%% Simplified macro definitions for Pandoc conversion
%%
%% This file replaces complex macro definitions from cplusplus-draft/source/macros.tex
%% with simpler forms that Pandoc can understand natively.
%% Used by the C++ standard converter to reduce Lua filter complexity.
%%
%% Strategy: Convert custom C++ standard macros to standard LaTeX commands
%% that Pandoc already knows how to handle (\texttt, \textit, etc.)
%%
%% ARCHITECTURAL DECISION: Prefer this file over Lua filters for:
%% - Pure typesetting commands (font styling, spacing, line breaking)
%% - Simple string substitutions (C++, NTBS, etc.)
%% - Commands appearing in BOTH BNF and code contexts
%%
%% WHY: One-line fixes work in ALL contexts (BNF, code, tables, text)
%% automatically, avoiding duplication across multiple Lua filters.
%%
%% Example: \itcorr was being stripped in multiple places. Moving it here
%% eliminated duplication and fixed bugs in one place.
%%--------------------------------------------------

%%--------------------------------------------------
%% Category A: Simple Text Substitutions
%% These are constant strings with no arguments
%%--------------------------------------------------
%% Remove line-breaking hints - these don't apply to markdown
\renewcommand{\-}{}           % Discretionary hyphen
\renewcommand{\linebreak}{}   % Line break hint
\renewcommand{\newline}{ }    % Strip line breaks - markdown doesn't support mid-table breaks
\renewcommand{\@}{}           % Sentence spacing control (LaTeX typography)
\renewcommand{\textregistered}{®}  % Registered trademark symbol
\renewcommand{\Cpp}{C++}
\renewcommand{\CppIII}{C++03}
\renewcommand{\CppXI}{C++11}
\renewcommand{\CppXIV}{C++14}
\renewcommand{\CppXVII}{C++17}
\renewcommand{\CppXX}{C++20}
\renewcommand{\CppXXIII}{C++23}
\renewcommand{\CppXXVI}{C++26}
\renewcommand{\IsoC}{ISO/IEC 9899:2018 (C)}
\renewcommand{\IsoPosix}{IEEE 1003.1-2017 (POSIX)}
\renewcommand{\IsoFloatUndated}{ISO/IEC 60559}
\renewcommand{\cv}{cv}
\renewcommand{\cvqual}[1]{\textit{#1}}
\renewcommand{\ntbs}{NTBS}
\renewcommand{\ntmbs}{NTMBS}
%% \caret - REMOVED: Pandoc can't handle \string^ properly, needs Lua filter
\renewcommand{\atsign}{@}
%% \unun - REMOVED: Pandoc can't handle \string_ properly, needs Lua filter
\renewcommand{\brk}{}  % Strip discretionary hyphen hints
\renewcommand{\tilde}{\textasciitilde}

%%--------------------------------------------------
%% Category B: Code Formatting
%% Convert to \texttt (monospace) - Pandoc renders as inline code
%%--------------------------------------------------
%% \tcode{} - REMOVED: contains nested macros (\keyword{}, \ctype{}, etc)
%% \ctype{} - REMOVED: nested in \tcode{}
%% \terminal{} - REMOVED: needs special handling in cpp-grammar.lua for BNF terminals
\renewcommand{\keyword}[1]{\texttt{#1}}
\renewcommand{\libheader}[1]{\texttt{<#1>}}
\renewcommand{\libheaderdef}[1]{\texttt{<#1>}}
\renewcommand{\libheaderref}[1]{\texttt{<#1>}}
\renewcommand{\libnoheader}[1]{\texttt{<#1>}}  % Reserved/absent header name (used in n4861+)
\renewcommand{\libconcept}[1]{\texttt{#1}}
\renewcommand{\exposconcept}[1]{\texttt{#1}}
\renewcommand{\libglobal}[1]{\texttt{#1}}
\renewcommand{\deflibconcept}[1]{\texttt{#1}}

%%--------------------------------------------------
%% Category C: Emphasis Formatting
%% Convert to \textit (italic) - Pandoc renders as emphasis
%%--------------------------------------------------
%% \grammarterm{} - REMOVED: context-dependent (BNF vs text), nested in \opt{}
%% \exposid{} - REMOVED: context-dependent (needs code+italic), moved to cpp-macros.lua
%% \exposidnc{} - REMOVED: context-dependent (needs code+italic), moved to cpp-macros.lua
%% \exposconceptnc{} - REMOVED: context-dependent (needs code+italic), moved to cpp-macros.lua
\renewcommand{\seebelownc}[1]{\textit{see below}}  % See below (no correction) - required arg consumes {}
%% \placeholder{} - REMOVED: context-dependent (code blocks vs text)
%% \placeholdernc{} - REMOVED: context-dependent (code blocks vs text)
\renewcommand{\defn}[1]{\textit{#1}}
\renewcommand{\defnx}[2]{\textit{#1}}
\renewcommand{\defnadjx}[3]{\textit{#1 #2}}
\renewcommand{\term}[1]{\textit{#1}}
\renewcommand{\techterm}[1]{\textit{#1}}  % Technical term (obsolete macro used in n3337-n4659)
\renewcommand{\oldconcept}[1]{\textit{Cpp17#1}}
\renewcommand{\doccite}[1]{\textit{#1}}
\renewcommand{\exposconceptx}[2]{\texttt{\textit{#1}}}  % Exposition-only concept with index

%%--------------------------------------------------
%% Category D: Library Specifications
%% Convert to italic text for semantic markers
%%--------------------------------------------------
\renewcommand{\seebelow}{\textit{see below}}
\renewcommand{\unspec}{\textit{unspecified}}
\renewcommand{\unspecnc}{\textit{unspecified}}
\renewcommand{\expos}{\textit{exposition only}}
\renewcommand{\impldef}[1]{\textit{implementation-defined}}
\renewcommand{\notdef}{\textit{not defined}}
\renewcommand{\impdef}{\textit{implementation-defined}}

%%--------------------------------------------------
%% Category E: Fundesc Labels
%% Specification section headers - italic labels
%%--------------------------------------------------
\renewcommand{\expects}{\textit{Preconditions:} }
\renewcommand{\requires}{\textit{Requires:} }
\renewcommand{\constraints}{\textit{Constraints:} }
\renewcommand{\effects}{\textit{Effects:} }
\renewcommand{\ensures}{\textit{Ensures:} }
\renewcommand{\returns}{\textit{Returns:} }
\renewcommand{\result}{\textit{Result:} }
\renewcommand{\complexity}{\textit{Complexity:} }
\renewcommand{\remarks}{\textit{Remarks:} }
\renewcommand{\throws}{\textit{Throws:} }
\renewcommand{\errors}{\textit{Error conditions:} }
\renewcommand{\mandates}{\textit{Mandates:} }
\renewcommand{\recommended}{\textit{Recommended practice:} }
\renewcommand{\required}{\textit{Required behavior:} }
\renewcommand{\default}{\textit{Default behavior:} }
\renewcommand{\sync}{\textit{Synchronization:} }
\renewcommand{\replaceable}{\textit{Replaceable:} }
\renewcommand{\returntype}{\textit{Return type:} }
\renewcommand{\cvalue}{\textit{Value:} }
\renewcommand{\templalias}{\textit{Alias template:} }
\renewcommand{\implimits}{\textit{Implementation limits:} }
\renewcommand{\postconditions}{\textit{Postconditions:} }
\renewcommand{\preconditions}{\textit{Preconditions:} }
\renewcommand{\realnote}{\textit{Note:} }
\renewcommand{\notes}{\textit{Remarks:} }  % Alias for \remarks (obsolete macro used in n3337-n4140)
\renewcommand{\realnotes}{\textit{Notes:} }  % Similar to \realnote but plural (obsolete macro used in n3337-n4140)

%%--------------------------------------------------
%% Category F: Ranges
%% Mathematical range notations with code formatting
%% Note: Square brackets wrapped in braces {[} {]} to escape them for Pandoc
%%--------------------------------------------------
\renewcommand{\range}[2]{{[}\texttt{#1}, \texttt{#2}{)}}
\renewcommand{\crange}[2]{{[}\texttt{#1}, \texttt{#2}{]}}
\renewcommand{\brange}[2]{{(}\texttt{#1}, \texttt{#2}{)}}
\renewcommand{\orange}[2]{{(}\texttt{#1}, \texttt{#2}{)}}
\renewcommand{\countedrange}[2]{\texttt{#1}+{[}0, \texttt{#2}{)}}

%%--------------------------------------------------
%% Category G: Change Descriptions
%% Appendix C compatibility markers
%%--------------------------------------------------
\renewcommand{\change}{\textbf{Change:} }
\renewcommand{\rationale}{\textbf{Rationale:} }
\renewcommand{\effect}{\textbf{Effect on original feature:} }

%%--------------------------------------------------
%% Category H: Special Formatting
%% Misc formatting helpers
%%--------------------------------------------------
%% \textbackslash - Removed: Already a standard LaTeX command, no need to redefine
\renewcommand{\cppver}{202302L}
\renewcommand{\tablerefheader}[1]{\textbf{#1}}
%% \stage{} - Removed: cpp-macros.lua needs to handle this for description list processing
\renewcommand{\columnline}{}  % Strip table column separators

%%--------------------------------------------------
%% Category I: Phase 3 Additions - Simple Unwrapping
%%--------------------------------------------------
\renewcommand{\deflibconcept}[1]{#1}
\renewcommand{\uname}[1]{#1}
%% \colcol - Removed: context-dependent, keep in Lua
%% \mathrm{} - Removed: standard LaTeX math command, different meaning in math mode
%% \bigoh{} - Removed: needs special handling in cpp-itemdecl.lua

%%--------------------------------------------------
%% Category J: Phase 4 Additions
%% Additional safe migrations from Lua filters
%%--------------------------------------------------
\renewcommand{\descr}[1]{#1}  % Description text - simple unwrapping
\renewcommand{\fmtgrammarterm}[1]{\textit{#1}}  % Format grammar term (always italic, unlike \grammarterm{})
\renewcommand{\UAX}[1]{UAX \##1}  % Unicode Annex reference - \# escapes the hash
\renewcommand{\opt}[1]{#1ₒₚₜ}  % Optional grammar element - consistent everywhere, uses Unicode subscripts

%%--------------------------------------------------
%% Category K: Math Operators
%% Bitwise shift operators for random number generators
%% NOTE: Unicode subscripts don't exist for all letters, so these
%% operators are left as LaTeX for MathJax rendering.
%%--------------------------------------------------
%% \leftshift{} and \rightshift - NOT simplified due to Unicode subscript limitations

%%--------------------------------------------------
%% Category L: Phase 5 Additions - Easy Win Macros
%% Found by analyzing trunk/ output for unconverted patterns
%%--------------------------------------------------

%% Code formatting for C preprocessor macros
\renewcommand{\libmacro}[1]{\texttt{#1}}

%% Grammar non-terminals
\renewcommand{\fmtnontermdef}[1]{\textit{#1}}  % Format string grammar
\renewcommand{\renontermdef}[1]{#1::}   % Regex grammar - just term+:: (like \locnontermdef)
\renewcommand{\defexposconceptnc}[1]{\textit{#1}}  % Exposition-only concepts

%% Math state variables: \state{X}{Y} → X_Y with subscripts
\renewcommand{\state}[2]{#1\ensuremath{_{#2}}}

%%--------------------------------------------------
%% Category M: BNF Typography Macros
%% Pure typesetting commands with no semantic meaning
%%--------------------------------------------------
\renewcommand{\BnfNontermshape}{}  % BNF font styling - strip for markdown
\renewcommand{\itcorr}[1][]{}      % Italic correction spacing - strip for markdown
\renewcommand{\locnontermdef}[1]{#1:}  % Locale BNF nonterminal - just term+colon

%%--------------------------------------------------
%% Macros removed after investigation (moved back to Lua filters):
%%  - \tcode{} - contains nested macros (\keyword{}, \ctype{}, \placeholder{}, etc)
%%  - \ctype{} - nested in \tcode{}
%%  - \grammarterm{} - context-dependent (BNF vs text)
%%  - \placeholder{}, \placeholdernc{} - context-dependent (code blocks vs text)
%%  - \exposid{}, \exposidnc{}, \exposconceptnc{} - context-dependent (need code+italic)
%%  - \stage{} - requires special handling in cpp-macros.lua for description lists
%%  - \textbackslash - already a standard LaTeX command
%%  - \colcol{}, \mathrm{}, \bigoh{} - context-dependent, keep in Lua filters
%%--------------------------------------------------
